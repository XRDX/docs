

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Clicker Hero &mdash; LeapJS 教程 beta 文档</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="Examples" href="example.html" />
    <link rel="prev" title="点击英雄" href="ClickerHero.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> LeapJS 教程
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">LeapJS 简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic_shapes/index.html">基本图形</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shapes/index.html">图片和动画</a></li>
<li class="toctree-l1"><a class="reference internal" href="../styles/index.html">样式</a></li>
<li class="toctree-l1"><a class="reference internal" href="../canvas/index.html">画布</a></li>
<li class="toctree-l1"><a class="reference internal" href="../audio/index.html">音乐与音效</a></li>
<li class="toctree-l1"><a class="reference internal" href="../events/index.html">事件处理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transform/index.html">图形变换</a></li>
<li class="toctree-l1"><a class="reference internal" href="../physical/index.html">物理效果</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">项目列表</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ClickerHero.html">点击英雄</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Clicker Hero</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#teaching-stage">Teaching Stage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#view-the-project">View the Project!</a></li>
<li class="toctree-l4"><a class="reference internal" href="#development-environment">Development environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ide-introduction">IDE Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#introduction-of-coordinates">Introduction of Coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#insert-a-picture">Insert a picture</a></li>
<li class="toctree-l4"><a class="reference internal" href="#move-it">Move it!</a></li>
<li class="toctree-l4"><a class="reference internal" href="#click-event">Click event</a></li>
<li class="toctree-l4"><a class="reference internal" href="#random-position">Random position</a></li>
<li class="toctree-l4"><a class="reference internal" href="#score">Score</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sound">Sound</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reconstruct">Reconstruct</a></li>
<li class="toctree-l4"><a class="reference internal" href="#challenge">Challenge</a></li>
<li class="toctree-l4"><a class="reference internal" href="#game-over">Game over</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#free-play">Free play</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="example.html">Examples</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">LeapJS 教程</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">项目列表</a> &raquo;</li>
        
      <li>Clicker Hero</li>
    
    

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="clicker-hero">
<span id="clicker-hero"></span><h1>Clicker Hero<a class="headerlink" href="#clicker-hero" title="永久链接至标题">¶</a></h1>
<div class="section" id="teaching-stage">
<span id="teaching-stage"></span><h2>Teaching Stage<a class="headerlink" href="#teaching-stage" title="永久链接至标题">¶</a></h2>
<div class="section" id="view-the-project">
<span id="view-the-project"></span><h3>View the Project!<a class="headerlink" href="#view-the-project" title="永久链接至标题">¶</a></h3>
<p>Open this URL：<a class="reference external" href="http://ide.leaplearner.com/lmumov/1">http://ide.leaplearner.com/lmumov/1</a>, Or scan the QR code to preview the project.</p>
<p><img alt="" src="../_images/clicker.png" /></p>
</div>
<div class="section" id="development-environment">
<span id="development-environment"></span><h3>Development environment<a class="headerlink" href="#development-environment" title="永久链接至标题">¶</a></h3>
<p>Open this URL: <a class="reference external" href="http://ide.leaplearner.com/jincai/1/edit?js,output">http://ide.leaplearner.com/jincai/1/edit</a>, Click <code class="docutils literal notranslate"><span class="pre">projects</span></code>-&gt;<code class="docutils literal notranslate"><span class="pre">clone</span></code>to start the project.
Record the string of 6 special characters in the middle of the URL, which is an
identification of everyone's project.</p>
</div>
<div class="section" id="ide-introduction">
<span id="ide-introduction"></span><h3>IDE Introduction<a class="headerlink" href="#ide-introduction" title="永久链接至标题">¶</a></h3>
<p>The following is a screenshot of the IDE of LeapLearner, you can see three parts, from left to right are：</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">JavaScript</span></code>area: the code area. It is the most important part, where we enter the code.</li>
<li><code class="docutils literal notranslate"><span class="pre">Output</span></code>area: the display area. It is to demonstrate the output.</li>
</ul>
<p><img alt="ide" src="projects\../images/ide.png" /></p>
<p><code class="docutils literal notranslate"><span class="pre">Share</span></code>: Click to generate link and QR code, you can share the project with others. Through the link or QR code, your friends can view your project.</p>
<p><code class="docutils literal notranslate"><span class="pre">Run</span></code>: run the code.</p>
<p><code class="docutils literal notranslate"><span class="pre">Auto-run</span></code>: After checking this button, as long as the code is modified, the code will be automatically executed.</p>
<p><code class="docutils literal notranslate"><span class="pre">↗</span></code>: Click to open a new tab page to present the project.</p>
<p><code class="docutils literal notranslate"><span class="pre">html</span></code>: it describes the content of the page.</p>
<p><code class="docutils literal notranslate"><span class="pre">console</span></code>: In the activated state, the log information and error messages will be showed in console.</p>
<p><code class="docutils literal notranslate"><span class="pre">css</span></code>: Used to configure the style of the page, not involved in this book.</p>
</div>
<div class="section" id="introduction-of-coordinates">
<span id="introduction-of-coordinates"></span><h3>Introduction of Coordinates<a class="headerlink" href="#introduction-of-coordinates" title="永久链接至标题">¶</a></h3>
<p>In order to define the position of space, mathematicians invented coordinates, Based on coordinates, geometry was developed. In computer graphics, the coordinate system is indispensable.</p>
<p>We will define the coordinates of the upper left corner as <code class="docutils literal notranslate"><span class="pre">(0,0)</span></code>, The horizontal axis is  defined as the <code class="docutils literal notranslate"><span class="pre">x-axis</span></code>The vertical coordinate is defined as the <code class="docutils literal notranslate"><span class="pre">y-axis</span></code>. Any point in the plane, the projection on the <code class="docutils literal notranslate"><span class="pre">x-axis</span></code>is called the <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">coordinate</span></code>, Similarly, the projection on the <code class="docutils literal notranslate"><span class="pre">y-axis</span></code> is the <code class="docutils literal notranslate"><span class="pre">y-coordinate</span></code>.Therefore, the coordinate system looks like this.</p>
<p>![pos_xy](../images/axis.axis</p>
<p>As long as we have the value of the coordinate point, we can easily determine its position.</p>
<blockquote>
<div><p>Tips: Cartesian coordinate system and web coordinate system</p>
<p>Unlike the mathematically common Cartesian coordinatesystem, the y-axis of the web page coordinate system is downward. This isbecause human reading habits is from left to right and from top to bottom, Define the location of coordinates according to this habit can make webpage design more reasonable.</p>
</div></blockquote>
</div>
<div class="section" id="insert-a-picture">
<span id="insert-a-picture"></span><h3>Insert a picture<a class="headerlink" href="#insert-a-picture" title="永久链接至标题">¶</a></h3>
<p>The defination of Sprite is as follows:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">Sprite</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li>url: the address of the picture.</li>
<li>x ,y: The horizontal and vertical coordinates of the upper left corner of the picture .</li>
<li>width, height: the width and height of the picture showed on canvas.</li>
</ul>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">bg</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Sprite</span><span class="p">(</span><span class="s2">&quot;http://orjajlo36.bkt.clouddn.com/backgroundimage2.jpg&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="mi">550</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Sprite</span><span class="p">(</span><span class="s2">&quot;http://ou1htxdl4.bkt.clouddn.com/coin.png&quot;</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
<span class="nx">bg</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
<span class="nx">item</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
</pre></div>
</div>
<p>Finally, use <code class="docutils literal notranslate"><span class="pre">draw</span></code> to insert a picture on canvas. Click on <code class="docutils literal notranslate"><span class="pre">Run</span></code> , you can draw these two pictures on the
canvas.</p>
</div>
<div class="section" id="move-it">
<span id="move-it"></span><h3>Move it!<a class="headerlink" href="#move-it" title="永久链接至标题">¶</a></h3>
<p>Let’s make the object move!.In canvas, every 16ms we draw the graph again. Because of the fast frequency switching, it looks like it is moving.</p>
<p>We need to define a function <code class="docutils literal notranslate"><span class="pre">GameLoop</span></code>. Its purpose is to draw the graph in each frame and call itself in the next frame.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">GameLoop</span><span class="p">(){</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
  
    <span class="nx">bg</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
    <span class="nx">nextFrame</span><span class="p">(</span><span class="nx">GameLoop</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">loadRssAndRun</span><span class="p">(</span><span class="nx">GameLoop</span><span class="p">);</span>
</pre></div>
</div>
<p>In <code class="docutils literal notranslate"><span class="pre">GameLoop</span></code>We increase the y value of the object by one each time to achieve the effect of moving</p>
<p>down. Finally, we use the function  <code class="docutils literal notranslate"><span class="pre">loadRssAndRun(GameLoop);</span></code> to load the picture.</p>
<p>The complete code is as follows:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">bg</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Sprite</span><span class="p">(</span><span class="s2">&quot;http://orjajlo36.bkt.clouddn.com/backgroundimage2.jpg&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="mi">550</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Sprite</span><span class="p">(</span><span class="s2">&quot;http://ou1htxdl4.bkt.clouddn.com/coin.png&quot;</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">GameLoop</span><span class="p">(){</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
  
    <span class="nx">bg</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
    <span class="nx">nextFrame</span><span class="p">(</span><span class="nx">GameLoop</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">loadRssAndRun</span><span class="p">(</span><span class="nx">GameLoop</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="click-event">
<span id="click-event"></span><h3>Click event<a class="headerlink" href="#click-event" title="永久链接至标题">¶</a></h3>
<p>When clicking the item, we need to make the object disappear, and then refresh a new object. In fact, we can make it easier by changing the coordinates of the object to zero.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">item</span><span class="p">.</span><span class="nx">click</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
</div>
<div class="section" id="random-position">
<span id="random-position"></span><h3>Random position<a class="headerlink" href="#random-position" title="永久链接至标题">¶</a></h3>
<p>Obviously it is not fun with the fixed position. Let's modify the horizontal position of the object at the same time, using Random.<code class="docutils literal notranslate"><span class="pre">Math.random()</span></code>will produce a random number from 0 to 1. Multiply by 300, it will produce a random number from 0 to 300.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">item</span><span class="p">.</span><span class="nx">click</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">300</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
</div>
<div class="section" id="score">
<span id="score"></span><h3>Score<a class="headerlink" href="#score" title="永久链接至标题">¶</a></h3>
<p>Thenext step is to record the game's score Add a variable <code class="docutils literal notranslate"><span class="pre">score</span></code>. The initial value is 0.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">score</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</pre></div>
</div>
<p>The numbers can not be displayed directly. We need to convert the numbers to strings. Using the string + numbers in JavaScript, the numbers can be automatically converted to strings.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">scoreMsg</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">GameLoop</span><span class="p">(){</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="nx">scoreMsg</span> <span class="o">=</span> <span class="s2">&quot;score:&quot;</span> <span class="o">+</span> <span class="nx">score</span><span class="p">;</span>
  
    <span class="nx">bg</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
    <span class="nx">scoreMsg</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
    <span class="nx">nextFrame</span><span class="p">(</span><span class="nx">GameLoop</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Hey, remember to increase the score when you successfully click on an object, or the score will not increase.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">item</span><span class="p">.</span><span class="nx">click</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">300</span><span class="p">;</span>
    <span class="nx">score</span><span class="o">++</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>The complete code is as follows:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">bg</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Sprite</span><span class="p">(</span><span class="s2">&quot;http://orjajlo36.bkt.clouddn.com/backgroundimage2.jpg&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="mi">550</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Sprite</span><span class="p">(</span><span class="s2">&quot;http://ou1htxdl4.bkt.clouddn.com/coin.png&quot;</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">score</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">scoreMsg</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">GameLoop</span><span class="p">(){</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="nx">scoreMsg</span> <span class="o">=</span> <span class="s2">&quot;score:&quot;</span> <span class="o">+</span> <span class="nx">score</span><span class="p">;</span>
  
    <span class="nx">bg</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
    <span class="nx">scoreMsg</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
    <span class="nx">nextFrame</span><span class="p">(</span><span class="nx">GameLoop</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">loadRssAndRun</span><span class="p">(</span><span class="nx">GameLoop</span><span class="p">);</span>

<span class="nx">item</span><span class="p">.</span><span class="nx">click</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">300</span><span class="p">;</span>
    <span class="nx">score</span><span class="o">++</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
</div>
<div class="section" id="sound">
<span id="sound"></span><h3>Sound<a class="headerlink" href="#sound" title="永久链接至标题">¶</a></h3>
<p>Adding sound to our program is to make the game more interesting. Let's add two sounds: the background music and the click sound effect</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">bgm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Audio</span><span class="p">();</span>
<span class="nx">bgm</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s2">&quot;http://oq2qlcey8.bkt.clouddn.com/bgm.mp3&quot;</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">clickSound</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Audio</span><span class="p">();</span>
<span class="nx">clickSound</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s2">&quot;http://llcs-1252287760.cossh.myqcloud.com/audio/gold.mp3&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>We need the background music play in a continuous loop.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">bgm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Audio</span><span class="p">();</span>
<span class="nx">bgm</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s2">&quot;http://oq2qlcey8.bkt.clouddn.com/bgm.mp3&quot;</span><span class="p">;</span>
<span class="nx">bgm</span><span class="p">.</span><span class="nx">loop</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">bgm</span><span class="p">.</span><span class="nx">play</span><span class="p">();</span>
</pre></div>
</div>
<p>The sound effect of clicking item is played when clicked, so we add it to the click.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">item</span><span class="p">.</span><span class="nx">click</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">300</span><span class="p">;</span>
    <span class="nx">score</span><span class="o">++</span><span class="p">;</span>
    <span class="nx">clickSound</span><span class="p">.</span><span class="nx">play</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Final Code</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">bg</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Sprite</span><span class="p">(</span><span class="s2">&quot;http://orjajlo36.bkt.clouddn.com/backgroundimage2.jpg&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="mi">550</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Sprite</span><span class="p">(</span><span class="s2">&quot;http://ou1htxdl4.bkt.clouddn.com/coin.png&quot;</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">bgm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Audio</span><span class="p">();</span>
<span class="nx">bgm</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s2">&quot;http://oq2qlcey8.bkt.clouddn.com/bgm.mp3&quot;</span><span class="p">;</span>
<span class="nx">bgm</span><span class="p">.</span><span class="nx">loop</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">bgm</span><span class="p">.</span><span class="nx">play</span><span class="p">();</span>

<span class="kd">var</span> <span class="nx">clickSound</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Audio</span><span class="p">();</span>
<span class="nx">clickSound</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s2">&quot;http://llcs-1252287760.cossh.myqcloud.com/audio/gold.mp3&quot;</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">score</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">scoreMsg</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">GameLoop</span><span class="p">(){</span>
   <span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
   <span class="nx">scoreMsg</span> <span class="o">=</span> <span class="s2">&quot;score:&quot;</span> <span class="o">+</span> <span class="nx">score</span><span class="p">;</span>
 
   <span class="nx">bg</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
   <span class="nx">item</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
   <span class="nx">scoreMsg</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
   <span class="nx">nextFrame</span><span class="p">(</span><span class="nx">GameLoop</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">loadRssAndRun</span><span class="p">(</span><span class="nx">GameLoop</span><span class="p">);</span>

<span class="nx">item</span><span class="p">.</span><span class="nx">click</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
   <span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="nx">item</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">300</span><span class="p">;</span>
   <span class="nx">score</span><span class="o">++</span><span class="p">;</span>
   <span class="nx">clickSound</span><span class="p">.</span><span class="nx">play</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
</div>
</div>
<div class="section" id="reconstruct">
<span id="reconstruct"></span><h3>Reconstruct<a class="headerlink" href="#reconstruct" title="永久链接至标题">¶</a></h3>
<p>Before moving on to the next chapter, let's make a slight adjustment to our program. Here's a line of codethat changes speed.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
</pre></div>
</div>
<p>Here <code class="docutils literal notranslate"><span class="pre">1</span></code> represents the speed, but it is not clear enough. So we define a variable <code class="docutils literal notranslate"><span class="pre">speed</span></code> to express it more intuitively.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">scoreMsg</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">speed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">...</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="nx">speed</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="challenge">
<span id="challenge"></span><h3>Challenge<a class="headerlink" href="#challenge" title="永久链接至标题">¶</a></h3>
<p>Next, let’s modify the difficulty of the game. We
increase the speed every time we score, which will increase the difficulty of the game!</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">item</span><span class="p">.</span><span class="nx">click</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">300</span><span class="p">;</span>
    <span class="nx">score</span><span class="o">++</span><span class="p">;</span>
    <span class="nx">speed</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="nx">clickSound</span><span class="p">.</span><span class="nx">play</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
</div>
<p>If you feel that the game becomes too difficult, you can lower this value and let thespeed increase slowly.</p>
</div>
<div class="section" id="game-over">
<span id="game-over"></span><h3>Game over<a class="headerlink" href="#game-over" title="永久链接至标题">¶</a></h3>
<p>At the end of the game, we wrote Game Over on the screen.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">GameOver</span><span class="p">(){</span>
    <span class="s1">&#39;Game Over&#39;</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="s2">&quot;white&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>How to judge the game is over or not? We need a pseudocode to determine it.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">If</span> <span class="nx">the</span> <span class="nx">object</span> <span class="nx">is</span> <span class="nx">beyond</span> <span class="nx">the</span> <span class="nx">canvas</span><span class="o">:</span> 
    <span class="nx">The</span> <span class="nx">game</span> <span class="nx">is</span> <span class="nx">over</span><span class="p">.</span>
<span class="nx">In</span> <span class="nx">other</span> <span class="nx">cases</span><span class="o">:</span>
    <span class="nx">Continue</span> <span class="nx">the</span> <span class="nx">game</span> <span class="nx">loop</span><span class="p">.</span>
</pre></div>
</div>
<p>You can write it in JavaScript as follows:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">GameLoop</span><span class="p">(){</span>
    <span class="p">...</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">&gt;</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span>
        <span class="nx">GameOver</span><span class="p">();</span>
    <span class="k">else</span>
        <span class="nx">nextFrame</span><span class="p">(</span><span class="nx">GameLoop</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Restart</p>
<p>Before restart the game loops,we need to:</p>
<ul class="simple">
<li>Clear the score</li>
<li>Put the object back to the top</li>
<li>Change the speed to the original speed</li>
</ul>
<p>Finally, run loops.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">GameStart</span><span class="p">(){</span>
    <span class="nx">score</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">speed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="nx">GameLoop</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>When shall we restart the game? We need a button to make the game restart at the end of the game.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">retry</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Sprite</span><span class="p">(</span> <span class="s2">&quot;http://osykyzwcn.bkt.clouddn.com/SHAYUx0001.png&quot;</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
<span class="nx">retry</span><span class="p">.</span><span class="nx">click</span> <span class="o">=</span> <span class="nx">GameStart</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">GameOver</span><span class="p">(){</span>
    <span class="s2">&quot;Game Over&quot;</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="s2">&quot;white&quot;</span><span class="p">);</span>
    <span class="nx">retry</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>    
<span class="p">}</span>
</pre></div>
</div>
<p>The button will be on the canvas when the game ends. You can click the button and restart the game then.</p>
<p>Final Code Line</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">bg</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Sprite</span><span class="p">(</span><span class="s2">&quot;http://orjajlo36.bkt.clouddn.com/backgroundimage2.jpg&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="mi">550</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Sprite</span><span class="p">(</span><span class="s2">&quot;http://ou1htxdl4.bkt.clouddn.com/coin.png&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">bgm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Audio</span><span class="p">();</span>
<span class="nx">bgm</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s2">&quot;http://oq2qlcey8.bkt.clouddn.com/bgm.mp3&quot;</span><span class="p">;</span>
<span class="nx">bgm</span><span class="p">.</span><span class="nx">loop</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">bgm</span><span class="p">.</span><span class="nx">play</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">sound</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Audio</span><span class="p">();</span>
<span class="nx">sound</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s2">&quot;http://llcs-1252287760.cossh.myqcloud.com/audio/gold.mp3&quot;</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">speed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">score</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">hiscore</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="nx">item</span><span class="p">.</span><span class="nx">click</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">score</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="nx">speed</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>

    <span class="nx">sound</span><span class="p">.</span><span class="nx">currentTime</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">sound</span><span class="p">.</span><span class="nx">play</span><span class="p">();</span>

    <span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">300</span><span class="p">;</span>
<span class="p">};</span>

<span class="kd">function</span> <span class="nx">GameStart</span><span class="p">(){</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">score</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">speed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="nx">GameLoop</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">GameLoop</span><span class="p">(){</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="nx">speed</span><span class="p">;</span>   
    <span class="nx">bg</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span> 
    <span class="kd">var</span> <span class="nx">scoreMsg</span> <span class="o">=</span> <span class="s2">&quot;Score: &quot;</span> <span class="o">+</span> <span class="nx">score</span><span class="p">;</span>
    <span class="nx">scoreMsg</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>

    <span class="k">if</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">&gt;</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span>
      <span class="nx">GameOver</span><span class="p">();</span>
    <span class="k">else</span>
      <span class="nx">nextFrame</span><span class="p">(</span><span class="nx">GameLoop</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">retry</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Sprite</span><span class="p">(</span> <span class="s2">&quot;http://osykyzwcn.bkt.clouddn.com/SHAYUx0001.png&quot;</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
<span class="nx">retry</span><span class="p">.</span><span class="nx">click</span> <span class="o">=</span> <span class="nx">GameStart</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">GameOver</span><span class="p">(){</span>
    <span class="s2">&quot;Game Over&quot;</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="s2">&quot;white&quot;</span><span class="p">);</span>
    <span class="nx">retry</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>    
<span class="p">}</span>

<span class="nx">loadRssAndRun</span><span class="p">(</span><span class="nx">GameStart</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="free-play">
<span id="free-play"></span><h2>Free play<a class="headerlink" href="#free-play" title="永久链接至标题">¶</a></h2>
<p>Primary level</p>
<ul class="simple">
<li>Replace pictures, music assets</li>
<li>Modify the game parameters, adjust the game difficulty</li>
</ul>
<p>Advanced level:</p>
<ul class="simple">
<li>Let props appear from other directions.</li>
<li>Add more elements to the interface.</li>
</ul>
<p>Senior level:</p>
<ul class="simple">
<li>Drop more props at the same time</li>
<li>Diversify the direction of movement</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="example.html" class="btn btn-neutral float-right" title="Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ClickerHero.html" class="btn btn-neutral" title="点击英雄" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Vic Wang.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'beta',
            LANGUAGE:'zh',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/GA.js"></script>
      <script type="text/javascript" src="../_static/googleAnalysis.js"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>