

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Learning Programing with LeapLearner (IV) &mdash; LeapJS 教程 beta 文档</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="测试题" href="../tests/index.html" />
    <link rel="prev" title="Learning Programing with LeapLearner (III)" href="Learning Programing with LeapLearner (CS3).html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> LeapJS 教程
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../basics/index.html">完整文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">LeapJS 宝典</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">LeapJS 从入门到精通</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Learning Programing with LeapLearner (CS1).html">Learning Programing with LeapLearner (I)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Learning Programing with LeapLearner (CS2).html">Learning Programing with LeapLearner (II)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Learning Programing with LeapLearner (CS3).html">Learning Programing with LeapLearner (III)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Learning Programing with LeapLearner (IV)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#">代码规范</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#">对象规则</a></li>
<li class="toctree-l4"><a class="reference internal" href="#">括号</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#i">语法基础I</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#">开发环境</a></li>
<li class="toctree-l4"><a class="reference internal" href="#">数据类型</a></li>
<li class="toctree-l4"><a class="reference internal" href="#">注释</a></li>
<li class="toctree-l4"><a class="reference internal" href="#">函数</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#">字符串</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#">连接</a></li>
<li class="toctree-l4"><a class="reference internal" href="#">转义</a></li>
<li class="toctree-l4"><a class="reference internal" href="#">属性和方法</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#"></a></li>
<li class="toctree-l3"><a class="reference internal" href="#">动画基础</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#">画布的清理</a></li>
<li class="toctree-l4"><a class="reference internal" href="#">间隔执行</a></li>
<li class="toctree-l4"><a class="reference internal" href="#">帧执行</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ii">语法基础II</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#">对象</a></li>
<li class="toctree-l4"><a class="reference internal" href="#">数组</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#"></a></li>
<li class="toctree-l3"><a class="reference internal" href="#">语法进阶</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#">构造函数</a></li>
<li class="toctree-l4"><a class="reference internal" href="#">对象原型</a></li>
<li class="toctree-l4"><a class="reference internal" href="#">创建实例</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#">物理效果</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#">移动</a></li>
<li class="toctree-l4"><a class="reference internal" href="#">反弹</a></li>
<li class="toctree-l4"><a class="reference internal" href="#">碰撞</a></li>
<li class="toctree-l4"><a class="reference internal" href="#">重力效果</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#"></a></li>
<li class="toctree-l3"><a class="reference internal" href="#">参考：库函数</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#math">Math</a></li>
<li class="toctree-l4"><a class="reference internal" href="#date">Date</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tests/index.html">测试题</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projects/index.html">项目列表</a></li>
<li class="toctree-l1"><a class="reference internal" href="../updates/index.html">参考书</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">LeapJS 教程</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">LeapJS 从入门到精通</a> &raquo;</li>
        
      <li>Learning Programing with LeapLearner (IV)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/books/Learning Programing with LeapLearner (CS4).md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="learning-programing-with-leaplearner-iv">
<span id="learning-programing-with-leaplearner-iv"></span><h1>Learning Programing with LeapLearner (IV)<a class="headerlink" href="#learning-programing-with-leaplearner-iv" title="永久链接至标题">¶</a></h1>
<div class="section" id="">
<span id="id1"></span><h2>代码规范<a class="headerlink" href="#" title="永久链接至标题">¶</a></h2>
<div class="section" id="">
<span id="id2"></span><h3>对象规则<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<p>将左花括号与对象名放在同一行</p>
<p>冒号与属性值间有个空格</p>
<p>字符串使用单引号，数字不需要</p>
<p>最后一个属性值后面不要加上逗号</p>
<p>将右花括号独立放在一行，并以分号作为结束的符号</p>
</div>
<div class="section" id="">
<span id="id3"></span><h3>括号<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<p>将花括号放在第一行的结尾</p>
<p>在空号前添加一个空格</p>
<p>将右花括号独立放在一行</p>
</div>
</div>
<div class="section" id="i">
<span id="i"></span><h2>语法基础I<a class="headerlink" href="#i" title="永久链接至标题">¶</a></h2>
<p>本章节全面介绍 JavaScript 核心语法，从最简单的开始讲起，循序渐进、由浅入深，力求清晰易懂。</p>
<p>小知识：Atwood定律</p>
<blockquote>
<div><p>程序员Jeff Atwood提出这么一条定律</p>
<p>所有可以用 JavaScript 编写的程序，最终都会出现 JavaScript 的版本。</p>
<p>(Any application that can be written in JavaScript will eventually be written in JavaScript.)</p>
</div></blockquote>
<div class="section" id="">
<span id="id4"></span><h3>开发环境<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<p>JavaScript 的开发环境非常方便配置，只要电脑安装了浏览器，就相当于搭建了一个开发环境。从菜单中选择<code class="docutils literal notranslate"><span class="pre">更多选项</span></code>→<code class="docutils literal notranslate"><span class="pre">开发者工具</span></code>，就可以在它的控制台运行 JavaScript 代码。</p>
<p>进入控制台以后，就可以在提示符后输入代码，然后按<code class="docutils literal notranslate"><span class="pre">Enter</span></code>键，代码就会执行。如果按<code class="docutils literal notranslate"><span class="pre">Shift</span> <span class="pre">+</span> <span class="pre">Enter</span></code>键，则是换行，不会触发执行。建议阅读本章节时，使用控制台来进行说明。</p>
<p>将下面的程序复制到“控制台”，按下回车后，就可以看到运行结果。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">welcome</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Hello &#39;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">welcome</span><span class="p">(</span><span class="s1">&#39;Vic&#39;</span><span class="p">)</span>
<span class="c1">// =&gt; Hello Vic</span>
</pre></div>
</div>
</div>
<div class="section" id="">
<span id="id5"></span><h3>数据类型<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<p>JavaScript 语言的每一个值，都属于某一种数据类型。JavaScript 的数据类型，共有六种。</p>
<ul class="simple">
<li>Number: 数值</li>
<li>String: 字符串</li>
<li>Boolean: 布尔值</li>
<li>undefined: 表示未定义或者不存在</li>
<li>null: 表示空值</li>
<li>Object: 对象</li>
</ul>
<p>通常，我们将数值、字符串、布尔值成为原始类型，它们无法再进行分割了。而对象往往是由多个原始类型的值组成的，可以看作是一个存放各种值的容器。至于undefined和null，一般将它们当作是两个特殊的值。</p>
<p>对象又可以分成三个子类型</p>
<ul class="simple">
<li>Object: 狭义的对象</li>
<li>Array: 数组</li>
<li>Function: 函数</li>
</ul>
<p>这里需要明确的是，JavaScript的所有数据，都可以视为广义的对象。不仅数组和函数属于对象，就连原始类型的数据（数值、字符串、布尔值）也可以用对象方式调用。为了避免混淆，此后除非特别声明，本教程的”对象“都特指狭义的对象。</p>
<p>狭义的对象和数组是两种不同的数据组合方式，而函数其实是处理数据的方法。JavaScript把函数当成一种数据类型，可以像其他类型的数据一样，进行赋值和传递，这为编程带来了很大的灵活性，体现了JavaScript作为“函数式语言”的本质。</p>
<div class="section" id="">
<span id="id6"></span><h4>数值<a class="headerlink" href="#" title="永久链接至标题">¶</a></h4>
<p>和很多编程语言不同的是，JavaScript的数值只有一种类型，没有区分整数、浮点数等类型。</p>
<p>以下值都是数值</p>
<ul class="simple">
<li>0, 1, 2, 3, ...</li>
<li>100, 230, 8888, ...</li>
<li>3.14, 0.01, 3.33333, ...</li>
<li>-1, -3.14, ...</li>
</ul>
<p>数值可以在JavaScript中直接进行运算，在计算机中，没有乘号和除号，一般用<code class="docutils literal notranslate"><span class="pre">*</span></code>来代表<code class="docutils literal notranslate"><span class="pre">x</span></code>号，用<code class="docutils literal notranslate"><span class="pre">/</span></code>来代表<code class="docutils literal notranslate"><span class="pre">÷</span></code> 。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> 
<span class="c1">// =&gt; 3</span>

<span class="mi">6</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span> 
<span class="c1">// =&gt; 26</span>

<span class="mi">20</span> <span class="o">/</span> <span class="mi">10</span> 
<span class="c1">// =&gt; 2</span>
</pre></div>
</div>
<p>在Console中执行运算时，直接输入<code class="docutils literal notranslate"><span class="pre">Enter</span></code>键就可以得到结果了，而不需要输入<code class="docutils literal notranslate"><span class="pre">=</span></code>号，如果不小心输入了<code class="docutils literal notranslate"><span class="pre">=</span></code>号，反而是得不到结果的。</p>
<div class="section" id="">
<span id="id7"></span><h5>数值的进制<a class="headerlink" href="#" title="永久链接至标题">¶</a></h5>
<p>使用字面量（literal）时，JavaScript 对整数提供四种进制的表示方法：十进制、十六进制、八进制、2进制。</p>
<ul class="simple">
<li>十进制</li>
<li>八进制：有前缀<code class="docutils literal notranslate"><span class="pre">0o</span></code>或<code class="docutils literal notranslate"><span class="pre">0O</span></code>的数值，或者有前导0、且只用到0-7的八个阿拉伯数字的数值。</li>
<li>十六进制：有前缀<code class="docutils literal notranslate"><span class="pre">0x</span></code>或<code class="docutils literal notranslate"><span class="pre">0X</span></code>的数值。</li>
<li>二进制：有前缀<code class="docutils literal notranslate"><span class="pre">0b</span></code>或<code class="docutils literal notranslate"><span class="pre">0B</span></code>的数值。</li>
</ul>
</div>
<div class="section" id="">
<span id="id8"></span><h5>小数<a class="headerlink" href="#" title="永久链接至标题">¶</a></h5>
<p>在JavaScript内部，所有数字都是以64位浮点数的形式储存，即时是整数也是如此。所有1和1.0是相同的。</p>
<p>在进行小数的运算和比较时要十分小心。这是因为计算机为了同有限的位数表示更多的数字，从而将小数转成非常接近的浮点数，浮点数并不是一个非常精确的值。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="mf">0.1</span> <span class="o">+</span> <span class="mf">0.2</span>
<span class="c1">// =&gt; 0.30000000000000004</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="">
<span id="id9"></span><h4>字符串<a class="headerlink" href="#" title="永久链接至标题">¶</a></h4>
<p>字符串是由0个或者多个排在一起的字符，放在单引号或双引号之中。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;hi&#39;</span>
<span class="s2">&quot;Hello&quot;</span>
</pre></div>
</div>
<p>字符串默认只能写在同一行，如果必须分成多行，可以在每一行的末尾使用反斜杠\</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;a very \</span>
<span class="s1">very \</span>
<span class="s1">long strory&#39;</span>
</pre></div>
</div>
<p>单引号字符串的内部，可以使用双引号。双引号字符串的内部，可以使用单引号。利用这个规则，我们可以合理的在字符串中使用双引号或者单引号。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;This is &quot;A&quot;&#39;</span>
<span class="s2">&quot;I&#39;m vic&quot;</span>
</pre></div>
</div>
<p>当然，如果非要在字符串里同时使用单引号和双引号，可以用\来转义</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;She said \&quot;Hello\, I\&#39;m Monica\&quot;&#39;</span>
</pre></div>
</div>
<div class="section" id="">
<span id="id10"></span><h5>转义<a class="headerlink" href="#" title="永久链接至标题">¶</a></h5>
<p>反斜杠（\）在字符串内有特殊含义，用来表示一些特殊字符，所以又称为转义符。</p>
<p>需要用反斜杠转义的特殊字符，主要有下面这些：</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">\0</span></code> null（\u0000）</li>
<li><code class="docutils literal notranslate"><span class="pre">\b</span></code> 后退键（\u0008）</li>
<li><code class="docutils literal notranslate"><span class="pre">\f</span></code> 换页符（\u000C）</li>
<li><code class="docutils literal notranslate"><span class="pre">\n</span></code> 换行符（\u000A）</li>
<li><code class="docutils literal notranslate"><span class="pre">\r</span></code> 回车键（\u000D）</li>
<li><code class="docutils literal notranslate"><span class="pre">\t</span></code> 制表符（\u0009）</li>
<li><code class="docutils literal notranslate"><span class="pre">\v</span></code> 垂直制表符（\u000B）</li>
<li><code class="docutils literal notranslate"><span class="pre">\'</span></code> 单引号（\u0027）</li>
<li><code class="docutils literal notranslate"><span class="pre">\&quot;</span></code> 双引号（\u0022）</li>
<li>\ 反斜杠（\u005C）</li>
</ul>
</div>
<div class="section" id="">
<span id="id11"></span><h5>字符串与数组<a class="headerlink" href="#" title="永久链接至标题">¶</a></h5>
<p>字符串可以被视为字符数组，因此可以使用数组的方括号运算符，用来返回某个位置的字符（位置编号从0开始）。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="s1">&#39;hello&#39;</span><span class="p">;</span>
<span class="nx">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">// =&gt; &quot;h&quot;</span>
<span class="nx">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1">// =&gt; &quot;e&quot;</span>
<span class="nx">s</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="c1">// =&gt; &quot;o&quot;</span>

<span class="s1">&#39;hello&#39;</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1">// =&gt; &quot;e&quot;</span>
</pre></div>
</div>
<p>但是，字符串与数组的相似性仅此而已。实际上，无法改变字符串之中的单个字符。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="s1">&#39;hello&#39;</span><span class="p">;</span>

<span class="k">delete</span> <span class="nx">s</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="nx">s</span> <span class="c1">// &quot;hello&quot;</span>

<span class="nx">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span><span class="p">;</span>
<span class="nx">s</span> <span class="c1">// &quot;hello&quot;</span>

<span class="nx">s</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;!&#39;</span><span class="p">;</span>
<span class="nx">s</span> <span class="c1">// &quot;hello&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="length">
<span id="length"></span><h5>length属性<a class="headerlink" href="#length" title="永久链接至标题">¶</a></h5>
<p><code class="docutils literal notranslate"><span class="pre">length</span></code>属性返回字符串的长度，该属性也是无法改变的。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="s1">&#39;hello&#39;</span><span class="p">;</span>
<span class="nx">s</span><span class="p">.</span><span class="nx">length</span> <span class="c1">// 5</span>

<span class="nx">s</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="nx">s</span><span class="p">.</span><span class="nx">length</span> <span class="c1">// 5</span>

<span class="nx">s</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
<span class="nx">s</span><span class="p">.</span><span class="nx">length</span> <span class="c1">// 5</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="">
<span id="id12"></span><h4>布尔值<a class="headerlink" href="#" title="永久链接至标题">¶</a></h4>
<p>布尔值只有2个值，<code class="docutils literal notranslate"><span class="pre">true</span></code>和<code class="docutils literal notranslate"><span class="pre">false</span></code>，分别代表真和假。在程序中一般和<code class="docutils literal notranslate"><span class="pre">if</span></code>一起使用，用于控制程序的走向。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="kc">true</span><span class="p">){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Hello!&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="c1">// =&gt; Hello!</span>
</pre></div>
</div>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="kc">false</span><span class="p">){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;World&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="c1">// 没有任何结果</span>
</pre></div>
</div>
<p>当然，以上2个程序没有任何实际用处，甚至你都会觉得多此一举。事实上，布尔值一般由运算产生，如下面这个例子，我们定义了一个函数<code class="docutils literal notranslate"><span class="pre">rank</span></code>来判断学生的成绩是不是合格。</p>
<div class="section" id="">
<span id="id13"></span><h5>实例：输出分数的结果<a class="headerlink" href="#" title="永久链接至标题">¶</a></h5>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">rank</span><span class="p">(</span><span class="nx">score</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">score</span> <span class="o">&gt;</span> <span class="mi">60</span><span class="p">)</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Pass&#39;</span><span class="p">);</span>
    <span class="k">else</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Fail!&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">rank</span><span class="p">(</span><span class="mi">70</span><span class="p">);</span> <span class="c1">// =&gt; Pass</span>
<span class="nx">rank</span><span class="p">(</span><span class="mi">40</span><span class="p">);</span> <span class="c1">// =&gt; Fail!</span>
</pre></div>
</div>
<p>在这里，通过一个<code class="docutils literal notranslate"><span class="pre">&gt;</span></code>的运算，产生了一个布尔值。从而控制程序输出不一样的内容。</p>
<p>其他返回布尔值的运算符</p>
<ul class="simple">
<li>&amp;&amp;, ||</li>
<li>!</li>
<li>===, !==, ==, !=</li>
<li>&lt;, &gt;, &lt;=, &gt;=</li>
</ul>
<p>所有JavaScript的对象都可以转换为布尔值，除了false以外，还有一些值会被当作是布尔值false。</p>
<ul class="simple">
<li>0</li>
<li>null</li>
<li>false</li>
<li>undefined</li>
<li>NaN</li>
<li>&quot;&quot; 以及 ''（空字符串）</li>
</ul>
<p>除了以上几类值外，其他的值都会被看作是true。我们可以利用这个特性简化代码。</p>
</div>
</div>
<div class="section" id="nullundefined">
<span id="nullundefined"></span><h4>null和undefined<a class="headerlink" href="#nullundefined" title="永久链接至标题">¶</a></h4>
<p>对于<code class="docutils literal notranslate"><span class="pre">null</span></code>和<code class="docutils literal notranslate"><span class="pre">undefined</span></code>，可以大致可以像下面这样理解。</p>
<p><code class="docutils literal notranslate"><span class="pre">null</span></code>表示空值，即该处的值现在为空。调用函数时，某个参数未设置任何值，这时就可以传入<code class="docutils literal notranslate"><span class="pre">null</span></code>。比如，某个函数接受引擎抛出的错误作为参数，如果运行过程中未出错，那么这个参数就会传入<code class="docutils literal notranslate"><span class="pre">null</span></code>，表示未发生错误。</p>
<p><code class="docutils literal notranslate"><span class="pre">undefined</span></code>表示“未定义”，如果声明了一个变量而未进行赋值，那么这个值就是<code class="docutils literal notranslate"><span class="pre">undefined</span></code></p>
<p>注意，JavaScript的标识名区分大小写，所以<code class="docutils literal notranslate"><span class="pre">undefined</span></code>和<code class="docutils literal notranslate"><span class="pre">null</span></code>不同于<code class="docutils literal notranslate"><span class="pre">Undefined</span></code>和<code class="docutils literal notranslate"><span class="pre">Null</span></code></p>
</div>
</div>
<div class="section" id="">
<span id="id14"></span><h3>注释<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<p>在JavaScript中，有两个常见的注释方式有两种，单行注释和多行注释。</p>
<div class="section" id="">
<span id="id15"></span><h4>单行注释<a class="headerlink" href="#" title="永久链接至标题">¶</a></h4>
<p>使用//来注释</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// this is the fist style, only this line is affected by the comment</span>
<span class="kd">var</span> <span class="nx">rect</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Rectangle</span><span class="p">();</span>

<span class="cm">/* here is the second </span>
<span class="cm">   and you can write as much lines as you want </span>
<span class="cm">   */</span>
<span class="nx">rect</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
</pre></div>
</div>
<p>良好的注释可以帮助理解代码，同时不会影响到代码的执行。</p>
</div>
</div>
<div class="section" id="">
<span id="id16"></span><h3>函数<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<p>函数是一段可以重复调用的代码块。函数还能接受输入的参数，不同的参数会返回不同的之。</p>
<div class="section" id="">
<span id="id17"></span><h4>声明<a class="headerlink" href="#" title="永久链接至标题">¶</a></h4>
<p>函数使用function来声明，function后面接的是函数名，函数名的命名规则和变量完全一致。函数名后面是一对圆括号，里面是传入的参数。在后面是函数体，用大括号包含起来。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">drawRect</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">w</span><span class="p">,</span> <span class="nx">h</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">rect</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Rectangle</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">w</span><span class="p">,</span> <span class="nx">h</span><span class="p">);</span>
    <span class="nx">rect</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>上面的代码声明了一个<code class="docutils literal notranslate"><span class="pre">drawRect</span></code>函数，它含有4个参数。</p>
<p>另外一种声明方式是将一个匿名函数赋值给变量。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">drawRect</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">w</span><span class="p">,</span> <span class="nx">h</span><span class="p">}{</span>
    <span class="kd">var</span> <span class="nx">rect</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Rectangle</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">w</span><span class="p">,</span> <span class="nx">h</span><span class="p">);</span>
    <span class="nx">rect</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>和变量一样，如果同一个函数名重复声明，后面的函数声明会覆盖前面的函数。</p>
</div>
<div class="section" id="">
<span id="id18"></span><h4>调用<a class="headerlink" href="#" title="永久链接至标题">¶</a></h4>
<p>使用函数时，只要按照定义的参数，按顺序输入正确的变量。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">drawRect</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="">
<span id="id19"></span><h4>函数的作用域<a class="headerlink" href="#" title="永久链接至标题">¶</a></h4>
<p>作用域是指变量存在的范围。在函数内部声明的变量只能在函数中使用。在函数外生命的变量叫做全局变量，可以在函数内部读取。</p>
</div>
</div>
</div>
<div class="section" id="">
<span id="id20"></span><h2>字符串<a class="headerlink" href="#" title="永久链接至标题">¶</a></h2>
<p>字符串是将字符串在一起，用单引号或者双引号包围的一串字符。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="s2">&quot;abc&quot;</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="s1">&#39;Hello, world!&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>注意，即时是空的<code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>或者<code class="docutils literal notranslate"><span class="pre">''</span></code>也是一个字符串。</p>
<div class="section" id="">
<span id="id21"></span><h3>连接<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<p>使用加号(<code class="docutils literal notranslate"><span class="pre">+</span></code>)可以将多个字符串拼接在一起。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">msg</span> <span class="o">=</span> <span class="s2">&quot;Hello&quot;</span> <span class="o">+</span> <span class="s2">&quot;World&quot;</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="">
<span id="id22"></span><h3>转义<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<p>但遇到一些特殊字符时，我们需要用反斜杠<code class="docutils literal notranslate"><span class="pre">\</span></code>来输入他们。</p>
</div>
<div class="section" id="">
<span id="id23"></span><h3>属性和方法<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">length</span></code>属性返回字符串的长度。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;abc&#39;</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="c1">// =&gt; 3</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="">
<span id="id24"></span><h2><a class="headerlink" href="#" title="永久链接至标题">¶</a></h2>
</div>
<div class="section" id="">
<span id="id25"></span><h2>动画基础<a class="headerlink" href="#" title="永久链接至标题">¶</a></h2>
<div class="section" id="">
<span id="id26"></span><h3>画布的清理<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<p>canvas有许多的方法，我们可以利用clear方法来清理画布上的图形，好让我们重新开始绘制图形。</p>
<div class="section" id="">
<span id="id27"></span><h4>实例：画布清理<a class="headerlink" href="#" title="永久链接至标题">¶</a></h4>
<p>第一步，让我们在画布上画上任意你想要花的图形。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">rect</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Rectangle</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="nx">rect</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
</pre></div>
</div>
<p>第二步，使用clear方法</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">canvas</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
</pre></div>
</div>
<p>发生了什么，一切都消失了，我们将画布上的图形全部清理了。</p>
<p>看起来clear这个方法好像很奇怪，我们如果需要一个空白的画布，一开始我们不往上画不就可以了？但是，利用这个方法以及下面的间隔执行，是创建一切动画的基础。</p>
</div>
</div>
<div class="section" id="">
<span id="id28"></span><h3>间隔执行<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">setInterval</span></code>是浏览器窗口自带的一个函数，接受1个函数名参数以及一个时间间隔参数。它可以在规定的时间间隔后执行函数，利用这一特性，我们可以定时绘制图形，从而达到让图形动起来的效果。</p>
<div class="section" id="">
<span id="id29"></span><h4>实例：间隔执行<a class="headerlink" href="#" title="永久链接至标题">¶</a></h4>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">rect</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Rectangle</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">loop</span><span class="p">(){</span>
    <span class="nx">rect</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="nx">rect</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="nx">rect</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
<span class="p">}</span>

<span class="nx">setInterval</span><span class="p">(</span><span class="nx">loop</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>
</pre></div>
</div>
<p>在这里，时间间隔的单位为毫秒<code class="docutils literal notranslate"><span class="pre">ms</span></code>，1s=1000ms。在上面的例子中，浏览器每过一秒就会调用<code class="docutils literal notranslate"><span class="pre">loop</span></code>一次。从而实现固定时间间隔执行代码。</p>
<blockquote>
<div><p><strong>小知识: window对象</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">setInterval</span></code>是浏览器<code class="docutils literal notranslate"><span class="pre">window</span></code>对象的一个方法，完整的写法是<code class="docutils literal notranslate"><span class="pre">window.setInterval</span></code>。在使用时，可以省去前面的<code class="docutils literal notranslate"><span class="pre">window</span></code>对象而直接使用。</p>
</div></blockquote>
<p>执行代码，我们可以看到每隔一秒，就会输出一个新的矩形，不停的重叠起来。如果，我们将原来的图形清除，是不是就会有一种图形动起来的感觉了！</p>
<p>![setInterval_1](..\images\setInterval_1.png)</p>
</div>
<div class="section" id="">
<span id="id30"></span><h4>实例：动画<a class="headerlink" href="#" title="永久链接至标题">¶</a></h4>
<p>在每次执行绘制前，清理掉屏幕。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">rect</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Rectangle</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">loop</span><span class="p">(){</span>
    <span class="nx">rect</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="nx">rect</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="nx">canvas</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
    <span class="nx">rect</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
<span class="p">}</span>

<span class="nx">setInterval</span><span class="p">(</span><span class="nx">loop</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>
</pre></div>
</div>
<p>快看，矩形动起来了！利用<code class="docutils literal notranslate"><span class="pre">setInterval</span></code>这个强大的功能，我们就可以让画面动起来了。</p>
<blockquote>
<div><p><strong>小知识：时间的单位</strong></p>
<p>我们知道1天=24个小时，1个小时=60分钟，1分钟=60秒。而在秒下面，还有更小的单位，毫秒和纳秒，1秒=1000毫秒，1毫秒=1000纳秒。
对计算机来说，1秒是非常长的时间，可以做多达十亿亿次以上的计算，因此在计算机的世界里，往往以毫秒(ms)作为时间的计量单位。</p>
</div></blockquote>
</div>
</div>
<div class="section" id="">
<span id="id31"></span><h3>帧执行<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">requestAnimationFrame</span></code>是浏览器用于刷新页面的一个接口，类似于setTimeout，主要用途是按帧对页面进行重绘。</p>
<p>设置这个API的目的是为了让各种网页动画效果（DOM动画、Canvas动画、SVG动画、WebGL动画）能够有一个统一的刷新机制，从而节省系统资源，提高系统性能，改善视觉效果。代码中使用这个API，就是告诉浏览器希望执行一个动画，让浏览器在下一个动画帧安排一次网页重绘。</p>
<p>requestAnimationFrame的优势，在于充分利用显示器的刷新机制，比较节省系统资源。显示器有固定的刷新频率（60Hz或75Hz），也就是说，每秒最多只能重绘60次或75次，requestAnimationFrame的基本思想就是与这个刷新频率保持同步，利用这个刷新频率进行页面重绘。此外，使用这个API，一旦页面不处于浏览器的当前标签，就会自动停止刷新。这就节省了CPU、GPU和电力。</p>
<p>requestAnimationFrame使用一个回调函数作为参数。这个回调函数会在浏览器重绘之前调用。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">requestAnimationFrame</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
</pre></div>
</div>
<p><strong>避免重复绘制</strong></p>
<p>在实际使用中，往往有多种情况需要使用<code class="docutils literal notranslate"><span class="pre">requestAnimationFrame</span></code>，如果在同一帧中多次调用了<code class="docutils literal notranslate"><span class="pre">requestAnimationFrame</span></code>，有可能导致多次执行。表现出动画加速，达不到预期的要求。</p>
<p>实例：错误使用<code class="docutils literal notranslate"><span class="pre">requestAnimationFrame</span></code>导致动画加速。</p>
<p>在LLEG中，可以使用nextFrame函数，这个函数保证了在下一帧中仅有函数被调用</p>
</div>
</div>
<div class="section" id="ii">
<span id="ii"></span><h2>语法基础II<a class="headerlink" href="#ii" title="永久链接至标题">¶</a></h2>
<div class="section" id="">
<span id="id32"></span><h3>对象<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<p>对象是JavaScript的核心概念，也是最重要的数据类型。简单说，对象是一种无序的数据集合，由若干的键值对构成。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">vic</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Vic&quot;</span><span class="p">,</span>
    <span class="nx">age</span><span class="o">:</span> <span class="mi">18</span>
<span class="p">}</span>
</pre></div>
</div>
<p>上面的代码中，大括号就定义了一个对象<code class="docutils literal notranslate"><span class="pre">vic</span></code>，他有2个键值对，<code class="docutils literal notranslate"><span class="pre">name</span></code>和<code class="docutils literal notranslate"><span class="pre">age</span></code>是键名，<code class="docutils literal notranslate"><span class="pre">&quot;Vic&quot;</span></code>和<code class="docutils literal notranslate"><span class="pre">28</span></code>是对应键的值。</p>
<div class="section" id="">
<span id="id33"></span><h4>属性<a class="headerlink" href="#" title="永久链接至标题">¶</a></h4>
<p>对象的每一个键名又称之为属性，我们可以用以下方法来获取该属性对应的属性值。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">vic</span><span class="p">.</span><span class="nx">name</span> <span class="c1">// =&gt; &quot;Vic&quot;</span>
</pre></div>
</div>
<p>还有一种是使用方括号运算符来读取属性值，使用方括号时，键名必须用字符串的形式。另外，数字键只能用方括号来读取，并且可以直接使用。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">vic</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="c1">// =&gt; &quot;Vic&quot;</span>
</pre></div>
</div>
<p>如果我们需要修改属性值，那么我们只要将重新给它赋值就可以了。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">vic</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s2">&quot;Tom&quot;</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="">
<span id="id34"></span><h4>方法<a class="headerlink" href="#" title="永久链接至标题">¶</a></h4>
<p>如果一个属性的值为函数，通常把这个属性称之为方法，它可以像函数那样调用。</p>
</div>
</div>
<div class="section" id="">
<span id="id35"></span><h3>数组<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<p>数组是按次序排列的一组值。每个值都有编号，而且是从0还是的。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">array</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;cc&#39;</span><span class="p">];</span>
</pre></div>
</div>
<p>上面的代码中，'a'是数组的0号位置。</p>
<p>本质上，数组是一种特殊的对象。</p>
<div class="section" id="length">
<span id="id36"></span><h4>length属性<a class="headerlink" href="#length" title="永久链接至标题">¶</a></h4>
<p>数组的length属性，返回数组的成员数量。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">array</span><span class="p">.</span><span class="nx">length</span> <span class="c1">// =&gt; 3</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="">
<span id="id37"></span><h2><a class="headerlink" href="#" title="永久链接至标题">¶</a></h2>
</div>
<div class="section" id="">
<span id="id38"></span><h2>语法进阶<a class="headerlink" href="#" title="永久链接至标题">¶</a></h2>
<p>面向对象编程是目前主流的编程范式。它将真实世界各种复杂的关系，抽象为一个个对象，然后由对象之间的分工与合作，完成对真实世界的模拟。</p>
<div class="section" id="">
<span id="id39"></span><h3>构造函数<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<p>构造函数和函数类型，使用<code class="docutils literal notranslate"><span class="pre">function</span></code>来定义。不一样的是，构造函数里使用了<code class="docutils literal notranslate"><span class="pre">this</span></code>来指代创建的实例。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">Human</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">age</span><span class="p">){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="nx">age</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="">
<span id="id40"></span><h3>对象原型<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<p>每个构造函数都有一个prototype属性，这个属性就是实例对象的原型对象。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">Human</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">sayHello</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>所有<code class="docutils literal notranslate"><span class="pre">Human</span></code>的实例便可以使用<code class="docutils literal notranslate"><span class="pre">Human</span></code>的原型函数了</p>
</div>
<div class="section" id="">
<span id="id41"></span><h3>创建实例<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<p>在使用实例前，我们需要创建一个实例。实例的创建</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">vic</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Human</span><span class="p">(</span><span class="s2">&quot;vic&quot;</span><span class="p">,</span> <span class="mi">18</span><span class="p">);</span>
</pre></div>
</div>
<p>使用new时，它做了以下事情</p>
<ul class="simple">
<li>创建一个空对象，作为将要返回的对象实例</li>
<li>将这个空对象的模型，指向构造函数的prototype属性</li>
<li>将这个空对象复制给函数内部的this关键字</li>
<li>开始执行构造函数内部的代码</li>
</ul>
</div>
</div>
<div class="section" id="">
<span id="id42"></span><h2>物理效果<a class="headerlink" href="#" title="永久链接至标题">¶</a></h2>
<div class="section" id="">
<span id="id43"></span><h3>移动<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<p>类似与坐标，我们可以将移动速度分解为2个方向，x和y轴上的速度。在每帧动画中，我们将图像的位置根据速度进行修正，就可以得到移动的效果。</p>
<p>速度的分解示意图</p>
<p>定义物体的速度</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">item</span><span class="p">.</span><span class="nx">xspeed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="nx">item</span><span class="p">.</span><span class="nx">yspeed</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</pre></div>
</div>
<p>通过运动公式</p>
<div class="highlight-latex notranslate"><div class="highlight"><pre><span></span>距离 = 速度 x 时间
</pre></div>
</div>
<p>我们可以知道，下一次物体位置变化为</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">item</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">item</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">xspeed</span> <span class="o">*</span> <span class="nx">t</span>
<span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">yspeed</span> <span class="o">*</span> <span class="nx">t</span>
</pre></div>
</div>
<p>在实际应用时，因为每帧动画的时间间隔一致，所以我们可以将t直接计算进speed中，从而简化为</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">item</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">item</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">xspeed</span><span class="p">;</span>
<span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">yspeed</span><span class="p">;</span>
</pre></div>
</div>
<p>可以简写为</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">item</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="nx">item</span><span class="p">.</span><span class="nx">xspeed</span><span class="p">;</span>
<span class="nx">item</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="nx">item</span><span class="p">.</span><span class="nx">yspeed</span><span class="p">;</span>
</pre></div>
</div>
<div class="section" id="">
<span id="id44"></span><h4>实例：移动的小球<a class="headerlink" href="#" title="永久链接至标题">¶</a></h4>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">ball</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Circle</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>

<span class="nx">ball</span><span class="p">.</span><span class="nx">xspeed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="nx">ball</span><span class="p">.</span><span class="nx">yspeed</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

<span class="nx">ball</span><span class="p">.</span><span class="nx">update</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">ball</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="nx">ball</span><span class="p">.</span><span class="nx">xspeed</span><span class="p">;</span>
    <span class="nx">ball</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="nx">ball</span><span class="p">.</span><span class="nx">yspeed</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">main</span><span class="p">(){</span>
  <span class="nx">canvas</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
  <span class="nx">ball</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>
  <span class="nx">ball</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
  <span class="nx">nextFrame</span><span class="p">(</span><span class="nx">main</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">main</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="ii">
<span id="id45"></span><h4>实例：移动的小球II<a class="headerlink" href="#ii" title="永久链接至标题">¶</a></h4>
<p>根据上面的例子，我们很快就可以写出让两个小球分布动起来的效果。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">ball1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Circle</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">ball2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Circle</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>

<span class="nx">ball1</span><span class="p">.</span><span class="nx">xspeed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="nx">ball1</span><span class="p">.</span><span class="nx">yspeed</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

<span class="nx">ball1</span><span class="p">.</span><span class="nx">xspeed</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="nx">ball1</span><span class="p">.</span><span class="nx">yspeed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="nx">ball1</span><span class="p">.</span><span class="nx">update</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">ball1</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="nx">ball1</span><span class="p">.</span><span class="nx">xspeed</span><span class="p">;</span>
    <span class="nx">ball1</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="nx">ball1</span><span class="p">.</span><span class="nx">yspeed</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">ball2</span><span class="p">.</span><span class="nx">update</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">ball2</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="nx">ball2</span><span class="p">.</span><span class="nx">xspeed</span><span class="p">;</span>
    <span class="nx">ball2</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="nx">ball2</span><span class="p">.</span><span class="nx">yspeed</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">main</span><span class="p">(){</span>
  <span class="nx">canvas</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
  <span class="nx">ball1</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>
  <span class="nx">ball1</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
  <span class="nx">ball2</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>
  <span class="nx">ball2</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
  <span class="nx">nextFrame</span><span class="p">(</span><span class="nx">main</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">main</span><span class="p">();</span>
</pre></div>
</div>
<p>但是，上面的代码有些地方重复了，因为我们写了两次的移动函数</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">ball1</span><span class="p">.</span><span class="nx">update</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">ball1</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="nx">ball1</span><span class="p">.</span><span class="nx">xspeed</span><span class="p">;</span>
    <span class="nx">ball1</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="nx">ball1</span><span class="p">.</span><span class="nx">yspeed</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">ball2</span><span class="p">.</span><span class="nx">update</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">ball2</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="nx">ball2</span><span class="p">.</span><span class="nx">xspeed</span><span class="p">;</span>
    <span class="nx">ball2</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="nx">ball2</span><span class="p">.</span><span class="nx">yspeed</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>而运动规则对这两个小球来说，应该是完全一致的，如果我们有3个、4个小球，那么他们的运行规则应该是一样的，那么我们能不能把这个规律总结出来呢。这时，就要引进一个非常重要的概念this。</p>
<p>this在JavaScript中代表了引用这个方法的主体，我们将上面的运动部分代码可以修改为：</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">ball1</span><span class="p">.</span><span class="nx">update</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">xspeed</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">yspeed</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">ball2</span><span class="p">.</span><span class="nx">update</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">xspeed</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">yspeed</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>可以发现，现在这两个方法是完全一模一样了。我们再将这个方法独立出来，命名为move，那么就可以写成下面的代码了。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">ball1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Circle</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">ball2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Circle</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>

<span class="nx">ball1</span><span class="p">.</span><span class="nx">xspeed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="nx">ball1</span><span class="p">.</span><span class="nx">yspeed</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

<span class="nx">ball1</span><span class="p">.</span><span class="nx">xspeed</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="nx">ball1</span><span class="p">.</span><span class="nx">yspeed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">move</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">xspeed</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">yspeed</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">ball1</span><span class="p">.</span><span class="nx">update</span> <span class="o">=</span> <span class="nx">move</span><span class="p">;</span>
<span class="nx">ball2</span><span class="p">.</span><span class="nx">update</span> <span class="o">=</span> <span class="nx">move</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">main</span><span class="p">(){</span>
  <span class="nx">canvas</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
  <span class="nx">ball1</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>
  <span class="nx">ball1</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
  <span class="nx">ball2</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>
  <span class="nx">ball2</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
  <span class="nx">nextFrame</span><span class="p">(</span><span class="nx">main</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">main</span><span class="p">();</span>
</pre></div>
</div>
<p>经过抽象后，如果我们需要添加更多的小球，那么显然也是轻而易举的事情了。</p>
</div>
</div>
<div class="section" id="">
<span id="id46"></span><h3>反弹<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<p>在很多PC上都有经典的弹球游戏，小球在碰到边界后自动弹回。</p>
<div class="section" id="">
<span id="id47"></span><h4>实例：反弹的小球<a class="headerlink" href="#" title="永久链接至标题">¶</a></h4>
<p>首先，让我们用伪代码来实现这个过程</p>
<p>伪代码</p>
<div class="highlight-latex notranslate"><div class="highlight"><pre><span></span>如果（小球碰到了右边），让小球的x速度等于负数
如果（小球碰到了左边），让小球的x速度等于正数
如果（小球碰到了上边），让小球的y速度等于正数
如果（小球碰到了下边），让小球的y速度等于负数
</pre></div>
</div>
<p>在代码实现上，就很容易将以上伪代码转为Javascript代码</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Circle</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>

<span class="nx">item</span><span class="p">.</span><span class="nx">xspeed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="nx">item</span><span class="p">.</span><span class="nx">yspeed</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

<span class="nx">item</span><span class="p">.</span><span class="nx">update</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">xspeed</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">yspeed</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">&gt;</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">xspeed</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">xspeed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">&gt;</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">yspeed</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">yspeed</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">};</span>

<span class="kd">function</span> <span class="nx">main</span><span class="p">(){</span>
  <span class="nx">canvas</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
  <span class="nx">item</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>
  <span class="nx">item</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
  <span class="nx">requestAnimationFrame</span><span class="p">(</span><span class="nx">main</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">main</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="">
<span id="id48"></span><h3>碰撞<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<p>在这里，我们提供了一个方法collide，可以支持图形对象的检测判断。</p>
<div class="section" id="">
<span id="id49"></span><h4>实例：圆和矩形<a class="headerlink" href="#" title="永久链接至标题">¶</a></h4>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">rect</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Rectangle</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">circle</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Circle</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>

<span class="nx">Mouse</span><span class="p">.</span><span class="nx">move</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">circle</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">Mouse</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
    <span class="nx">circle</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">Mouse</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
<span class="p">};</span>

<span class="p">(</span><span class="kd">function</span> <span class="nx">main</span><span class="p">(){</span>
    <span class="nx">canvas</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
    <span class="nx">rect</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
    <span class="nx">circle</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">p</span> <span class="o">=</span> <span class="nx">circle</span><span class="p">.</span><span class="nx">collide</span><span class="p">(</span><span class="nx">rect</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">p</span><span class="p">){</span>
        <span class="k">new</span> <span class="nx">Point</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">p</span><span class="p">.</span><span class="nx">y</span><span class="p">).</span><span class="nx">draw</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="nx">nextFrame</span><span class="p">(</span><span class="nx">main</span><span class="p">);</span>
<span class="p">}());</span>
</pre></div>
</div>
</div>
<div class="section" id="">
<span id="id50"></span><h4>实例：一群碰撞的圆<a class="headerlink" href="#" title="永久链接至标题">¶</a></h4>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">r</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">cs</span> <span class="o">=</span> <span class="p">[];</span>
<span class="kd">var</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">update</span><span class="p">(){</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">count</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
        <span class="nx">c</span> <span class="o">=</span> <span class="nx">cs</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">c</span> <span class="o">==</span> <span class="k">this</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">collide</span><span class="p">(</span><span class="nx">c</span><span class="p">);</span>

        <span class="k">if</span><span class="p">(</span><span class="nx">p</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">x</span> <span class="o">!=</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">-=</span> <span class="mi">5</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span><span class="o">/</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">y</span> <span class="o">!=</span> <span class="k">this</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">-=</span> <span class="mi">5</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">y</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span><span class="o">/</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">y</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">&lt;</span> <span class="nx">r</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">r</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">&lt;</span> <span class="nx">r</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">r</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="nx">r</span> <span class="o">&gt;</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span> <span class="o">-</span> <span class="nx">r</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="nx">r</span> <span class="o">&gt;</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span> <span class="o">-</span> <span class="nx">r</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">count</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
    <span class="nx">c</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Circle</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="o">+</span><span class="nx">i</span><span class="p">,</span> <span class="nx">r</span><span class="p">);</span>
    <span class="nx">c</span><span class="p">.</span><span class="nx">update</span> <span class="o">=</span> <span class="nx">update</span><span class="p">;</span>
    <span class="nx">cs</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">c</span><span class="p">);</span>
<span class="p">}</span>

<span class="p">(</span><span class="kd">function</span> <span class="nx">main</span><span class="p">(){</span>
    <span class="nx">canvas</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">cs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
        <span class="nx">cs</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">update</span><span class="p">();</span>
    <span class="nx">cs</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
    <span class="nx">nextFrame</span><span class="p">(</span><span class="nx">main</span><span class="p">);</span>
<span class="p">})();</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="">
<span id="id51"></span><h3>重力效果<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<div class="section" id="">
<span id="id52"></span><h4>实例：重力小球<a class="headerlink" href="#" title="永久链接至标题">¶</a></h4>
<p>在地球上，重力无所不再，牛顿发现了其中的规律并总结为定律，后人称之为牛顿第二定律。
$$
s = s + v · dt \v = v + a · dt
$$
如果我们固定每次变化的间隔，那么公式可以简化为</p>
<div class="highlight-latex notranslate"><div class="highlight"><pre><span></span>yspeed = yspeed + g;
y = y + yspeed;
</pre></div>
</div>
<p>这就是重力公式在画布上的表示，我们可以写出以下代码来实现重力效果。</p>
</div>
<div class="section" id="">
<span id="id53"></span><h4>实例：一个颠球小游戏的实现<a class="headerlink" href="#" title="永久链接至标题">¶</a></h4>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">canvas</span><span class="p">.</span><span class="nx">resize</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">ball</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Circle</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">g</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>

<span class="nx">ball</span><span class="p">.</span><span class="nx">yspeed</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nx">score</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nx">scoreMsg</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Text</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">);</span>

<span class="nx">ball</span><span class="p">.</span><span class="nx">click</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">yspeed</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span><span class="p">;</span>
    <span class="nx">score</span><span class="o">++</span><span class="p">;</span>
    <span class="nx">scoreMsg</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">score</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">ball</span><span class="p">.</span><span class="nx">update</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">yspeed</span> <span class="o">+=</span> <span class="nx">g</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">yspeed</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">&gt;</span> <span class="mi">450</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">450</span><span class="p">;</span>
      <span class="nx">score</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="kd">function</span> <span class="nx">loop</span><span class="p">(){</span>
  <span class="nx">canvas</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
  <span class="nx">ball</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>
  <span class="nx">ball</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
  <span class="nx">scoreMsg</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
  <span class="nx">requestAnimationFrame</span><span class="p">(</span><span class="nx">loop</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">loop</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="flappy-bird">
<span id="flappy-bird"></span><h4>实例：Flappy Bird<a class="headerlink" href="#flappy-bird" title="永久链接至标题">¶</a></h4>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">&quot;http://llcs-1252287760.cossh.myqcloud.com/&quot;</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">sky</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Sprite</span><span class="p">(</span><span class="nx">url</span><span class="o">+</span><span class="s2">&quot;bgs/bg.png&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">450</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">ground</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Sprite</span><span class="p">(</span><span class="nx">url</span><span class="o">+</span><span class="s2">&quot;bgs/ground.png&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">430</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">150</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">bird</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Animation</span><span class="p">(</span><span class="nx">url</span><span class="o">+</span><span class="s2">&quot;animations/bird.png&quot;</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">42</span><span class="p">);</span>
<span class="nx">bird</span><span class="p">.</span><span class="nx">setFrame</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// shiftX, shiftY, frameX, frameY, columns, rows</span>
<span class="nx">bird</span><span class="p">.</span><span class="nx">setAnchor</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>         
<span class="nx">bird</span><span class="p">.</span><span class="nx">scale</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>      <span class="c1">// These two lines are used to flip bird</span>
<span class="nx">bird</span><span class="p">.</span><span class="nx">setCollisionScale</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">);</span>   <span class="c1">// the actual collision scale</span>

<span class="kd">var</span> <span class="nx">spike1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Sprite</span><span class="p">(</span><span class="nx">url</span><span class="o">+</span><span class="s2">&quot;images/spike3.png&quot;</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">170</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">spike2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Sprite</span><span class="p">(</span><span class="nx">url</span><span class="o">+</span><span class="s2">&quot;images/spike3.png&quot;</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">170</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">bgm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Audio</span><span class="p">();</span>
<span class="nx">bgm</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">url</span><span class="o">+</span><span class="s2">&quot;audio/bgm.mp3&quot;</span><span class="p">;</span>
<span class="nx">bgm</span><span class="p">.</span><span class="nx">loop</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">bgm</span><span class="p">.</span><span class="nx">play</span><span class="p">();</span>

<span class="kd">var</span> <span class="nx">sound</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Audio</span><span class="p">();</span> 
<span class="nx">sound</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">url</span><span class="o">+</span><span class="s2">&quot;audio/jump.mp3&quot;</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">collideSound</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Audio</span><span class="p">();</span>
<span class="nx">collideSound</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">url</span><span class="o">+</span><span class="s2">&quot;audio/collision.mp3&quot;</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">score</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">hiscore</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="nx">spike1</span><span class="p">.</span><span class="nx">update</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="o">-</span><span class="mi">6</span><span class="p">;</span>                         <span class="c1">// Moving speed</span>
  <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">width</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">){</span>          <span class="c1">// If spike move out canvas</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">200</span> <span class="o">+</span> <span class="mi">200</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">();</span> <span class="c1">// Spike in the buttom</span>
    <span class="nx">score</span><span class="o">++</span><span class="p">;</span> 
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">spike2</span><span class="p">.</span><span class="nx">update</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">spike1</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">spike1</span><span class="p">.</span><span class="nx">y</span> <span class="o">-</span> <span class="mi">360</span> <span class="o">+</span> <span class="nx">score</span><span class="o">*</span><span class="mi">5</span><span class="p">;</span> <span class="c1">// Gap between spikes</span>
<span class="p">};</span>

<span class="nx">bird</span><span class="p">.</span><span class="nx">update</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">yspeed</span> <span class="o">+=</span> <span class="mf">0.5</span><span class="p">;</span>               <span class="c1">// Gravity</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">yspeed</span><span class="p">;</span>
<span class="p">};</span>

<span class="kd">function</span> <span class="nx">moveAndDraw</span><span class="p">(</span><span class="nx">speed</span><span class="p">){</span>    <span class="c1">// scene comes with same scene</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">translate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">-=</span> <span class="nx">speed</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="o">&lt;-</span><span class="k">this</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// move out from canvas</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">translate</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
<span class="p">}</span>

<span class="nx">sky</span><span class="p">.</span><span class="nx">moveAndDraw</span> <span class="o">=</span> <span class="nx">moveAndDraw</span><span class="p">;</span>
<span class="nx">ground</span><span class="p">.</span><span class="nx">moveAndDraw</span> <span class="o">=</span> <span class="nx">moveAndDraw</span><span class="p">;</span>
  
<span class="nx">Mouse</span><span class="p">.</span><span class="nx">down</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">isGameOver</span><span class="p">()){</span>
    <span class="nx">GameStart</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="nx">bird</span><span class="p">.</span><span class="nx">yspeed</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="p">;</span>          <span class="c1">// Bird jump speed</span>
    <span class="nx">sound</span><span class="p">.</span><span class="nx">currentTime</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">sound</span><span class="p">.</span><span class="nx">play</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="kd">function</span> <span class="nx">GameStart</span><span class="p">(){</span>
  <span class="nx">score</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nx">bird</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
  <span class="nx">bird</span><span class="p">.</span><span class="nx">yspeed</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span><span class="p">;</span>
  <span class="nx">spike1</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">600</span><span class="p">;</span>
  <span class="nx">spike2</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">600</span><span class="p">;</span>
  <span class="nx">bgm</span><span class="p">.</span><span class="nx">play</span><span class="p">();</span>
  <span class="nx">GameLoop</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">GameLoop</span><span class="p">(){</span>  
  <span class="k">if</span><span class="p">(</span><span class="nx">isGameOver</span><span class="p">()){</span>
    <span class="s2">&quot;Game Over TT&quot;</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="mi">110</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span>
    <span class="s2">&quot;Try Again&quot;</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="mi">130</span><span class="p">,</span> <span class="mi">240</span><span class="p">);</span>
    <span class="nx">collideSound</span><span class="p">.</span><span class="nx">play</span><span class="p">();</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">canvas</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>

    <span class="nx">sky</span><span class="p">.</span><span class="nx">moveAndDraw</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>  

    <span class="nx">spike1</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>
    <span class="nx">spike2</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>
    <span class="nx">bird</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>
      
    <span class="nx">spike1</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
    <span class="nx">spike2</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>

    <span class="nx">ground</span><span class="p">.</span><span class="nx">moveAndDraw</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>      <span class="c1">// On top of spikes, keep same speed with spikes</span>
    <span class="nx">bird</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>

    <span class="p">(</span><span class="s2">&quot;score:&quot;</span> <span class="o">+</span> <span class="nx">score</span><span class="p">).</span><span class="nx">draw</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;white&quot;</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">hiscore</span> <span class="o">&lt;</span> <span class="nx">score</span><span class="p">)</span> <span class="nx">hiscore</span> <span class="o">=</span> <span class="nx">score</span><span class="p">;</span>
    <span class="p">(</span><span class="s2">&quot;HI:&quot;</span> <span class="o">+</span> <span class="nx">hiscore</span><span class="p">).</span><span class="nx">draw</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;white&quot;</span><span class="p">);</span>

    <span class="nx">nextFrame</span><span class="p">(</span><span class="nx">GameLoop</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">isGameOver</span><span class="p">(){</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">bird</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="nx">bird</span><span class="p">.</span><span class="nx">height</span> <span class="o">&gt;</span> <span class="nx">ground</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">bird</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="nx">bird</span><span class="p">.</span><span class="nx">height</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>  
  <span class="k">if</span><span class="p">(</span><span class="nx">bird</span><span class="p">.</span><span class="nx">collide</span><span class="p">(</span><span class="nx">spike1</span><span class="p">)</span> <span class="o">||</span> <span class="nx">bird</span><span class="p">.</span><span class="nx">collide</span><span class="p">(</span><span class="nx">spike2</span><span class="p">))</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">loadRssAndRun</span><span class="p">(</span><span class="nx">GameStart</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="">
<span id="id54"></span><h2><a class="headerlink" href="#" title="永久链接至标题">¶</a></h2>
</div>
<div class="section" id="">
<span id="id55"></span><h2>参考：库函数<a class="headerlink" href="#" title="永久链接至标题">¶</a></h2>
<div class="section" id="math">
<span id="math"></span><h3>Math<a class="headerlink" href="#math" title="永久链接至标题">¶</a></h3>
<div class="section" id="">
<span id="id56"></span><h4>随机数<a class="headerlink" href="#" title="永久链接至标题">¶</a></h4>
<p>Math.random()</p>
<p>返回一个0到1的随机数，利用这个特性我们可以</p>
<p>注意：随机数的加法和乘法</p>
<p>Math.random() + Math.random() 能够生成 0-2的随机数字，但是结果并非均匀分布的，如果使用这种方式生成随机数，产生的结果会和你的预期可能会有较大出入。</p>
<p>同样，Math.random() * Math.random()的结果也非均匀分布的，在使用随机数的时候一定要注意这两点。</p>
<p>Math.floor()</p>
<div class="section" id="">
<span id="id57"></span><h5>实例：三角形<a class="headerlink" href="#" title="永久链接至标题">¶</a></h5>
<p>在画布上绘制出一个直角三角形，斜边长度是200，其中一个角是30°。</p>
<p>依据直角三角形的定理，我们可以知道</p>
<div class="highlight-latex notranslate"><div class="highlight"><pre><span></span>a = c * sin(30°)
b = c * cos(30°)
</pre></div>
</div>
<p>因此，我们假定直角定点是100, 100，那么其他两个顶点可以由此计算出来</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">x1</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="nx">y1</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="nx">c</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">x2</span> <span class="o">=</span> <span class="nx">x1</span> <span class="o">+</span> <span class="nx">c</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="mi">30</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">/</span> <span class="mi">180</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">y2</span> <span class="o">=</span> <span class="nx">y1</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">x3</span> <span class="o">=</span> <span class="nx">x1</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">y3</span> <span class="o">=</span> <span class="nx">y1</span> <span class="o">+</span> <span class="nx">c</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="mi">30</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">/</span> <span class="mi">180</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">tri</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Triangle</span><span class="p">(</span><span class="nx">x1</span><span class="p">,</span> <span class="nx">y1</span><span class="p">,</span> <span class="nx">x2</span><span class="p">,</span> <span class="nx">y2</span><span class="p">,</span> <span class="nx">x3</span><span class="p">,</span> <span class="nx">y3</span><span class="p">);</span>
<span class="nx">tri</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
</pre></div>
</div>
<p>就得到我们想要的三角形了。</p>
<p><img alt="math" src="../_images/math.png" /></p>
</div>
</div>
<div class="section" id="">
<span id="id58"></span><h4>方法<a class="headerlink" href="#" title="永久链接至标题">¶</a></h4>
<p>| 方法         | 描述                                       |
| ---------- | ---------------------------------------- |
| abs(x)     | 返回数的绝对值。                                 |
| acos(x)    | 返回数的反余弦值。                                |
| asin(x)    | 返回数的反正弦值。                                |
| atan(x)    | 以介于 -PI/2 与 PI/2 弧度之间的数值来返回 x 的反正切值。     |
| atan2(y,x) | 返回从 x 轴到点 (x,y) 的角度（介于 -PI/2 与 PI/2 弧度之间）。 |
| ceil(x)    | 对数进行上舍入。                                 |
| cos(x)     | 返回数的余弦。                                  |
| exp(x)     | 返回 e 的指数。                                |
| floor(x)   | 对数进行下舍入。                                 |
| log(x)     | 返回数的自然对数（底为e）。                           |
| max(x,y)   | 返回 x 和 y 中的最高值。                          |
| min(x,y)   | 返回 x 和 y 中的最低值。                          |
| pow(x,y)   | 返回 x 的 y 次幂。                             |
| random()   | 返回 0 ~ 1 之间的随机数。                         |
| round(x)   | 把数四舍五入为最接近的整数。                           |
| sin(x)     | 返回数的正弦。                                  |
| sqrt(x)    | 返回数的平方根。                                 |
| tan(x)     | 返回角的正切。                                  |
| toSource() | 返回该对象的源代码。                               |
| valueOf()  | 返回 Math 对象的原始值。                          |</p>
</div>
</div>
<div class="section" id="date">
<span id="date"></span><h3>Date<a class="headerlink" href="#date" title="永久链接至标题">¶</a></h3>
<p>Date 对象用于处理日期和时间。</p>
<p>可以通过 <code class="docutils literal notranslate"><span class="pre">new</span></code> 关键词来定义 <code class="docutils literal notranslate"><span class="pre">Date</span></code> 对象。以下代码定义了名为 <code class="docutils literal notranslate"><span class="pre">date</span></code>的 <code class="docutils literal notranslate"><span class="pre">Date</span></code> 对象：</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">date</span> <span class="o">=</span><span class="k">new</span> <span class="nb">Date</span><span class="p">()</span> 
</pre></div>
</div>
<p>注释：Date 对象自动使用当前的日期和时间作为其初始值。</p>
<p>| 方法             | 说明                      |
| -------------- | ----------------------- |
| <code class="docutils literal notranslate"><span class="pre">getHours()</span></code>   | 返回 Date 对象的小时 (0 ~ 23)。 |
| <code class="docutils literal notranslate"><span class="pre">getMinutes()</span></code> | 返回 Date 对象的分钟 (0 ~ 59)。 |
| <code class="docutils literal notranslate"><span class="pre">getSeconds()</span></code> | 返回 Date 对象的秒数 (0 ~ 59)。 |</p>
<div class="section" id="">
<span id="id59"></span><h4>实例：显示时间<a class="headerlink" href="#" title="永久链接至标题">¶</a></h4>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">now</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>

<span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="nx">now</span><span class="p">.</span><span class="nx">getHours</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">m</span> <span class="o">=</span> <span class="nx">now</span><span class="p">.</span><span class="nx">getMinutes</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">now</span><span class="p">.</span><span class="nx">getSeconds</span><span class="p">();</span>

<span class="kd">var</span> <span class="nx">time</span> <span class="o">=</span> <span class="nx">h</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="nx">m</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="nx">s</span><span class="p">;</span>
<span class="nx">time</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
</pre></div>
</div>
<p>每次运行时，都会依据你当前的时间来显示</p>
<p><img alt="date" src="../_images/date.png" /></p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../tests/index.html" class="btn btn-neutral float-right" title="测试题" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Learning Programing with LeapLearner (CS3).html" class="btn btn-neutral" title="Learning Programing with LeapLearner (III)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Vic Wang.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'beta',
            LANGUAGE:'zh',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/GA.js"></script>
      <script type="text/javascript" src="../_static/googleAnalysis.js"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>